From 9ca04f1e1e22669ae52e477266d0ddfcaac9bda7 Mon Sep 17 00:00:00 2001
From: Ricardo Salveti <ricardo@opensourcefoundries.com>
Date: Sat, 24 Feb 2018 21:00:37 -0300
Subject: [PATCH 2/5] colibri_imx7: run distro_bootcmd by default

Signed-off-by: Ricardo Salveti <ricardo@opensourcefoundries.com>
---
 include/configs/colibri_imx7.h      | 10 +++-------
 include/configs/colibri_imx7_emmc.h |  8 ++------
 2 files changed, 5 insertions(+), 13 deletions(-)

diff --git a/include/configs/colibri_imx7.h b/include/configs/colibri_imx7.h
index 3903591f9a..b3a785304b 100644
--- a/include/configs/colibri_imx7.h
+++ b/include/configs/colibri_imx7.h
@@ -116,16 +116,12 @@
 		"run fdt_fixup && bootz ${kernel_addr_r} - ${fdt_addr_r}\0"
 #endif /* CONFIG_TDX_EASY_INSTALLER */
 
-#ifdef CONFIG_TDX_EASY_INSTALLER
-#define CONFIG_BOOTCOMMAND "setenv fdtfile ${soc}-colibri-${fdt_board}.dtb && " \
-	"run bootcmd_mmc0; run ubiboot; run distro_bootcmd"
-#else
-#define CONFIG_BOOTCOMMAND "run ubiboot; " \
-	"setenv fdtfile ${soc}-colibri-${fdt_board}.dtb && run distro_bootcmd"
-#endif
+#define CONFIG_BOOTCOMMAND \
+	"setenv fdtfile ${soc}-colibri-${fdt_board}.dtb && run distro_bootcmd;"
 
 #define BOOTENV_RUN_NET_USB_START ""
 #define BOOT_TARGET_DEVICES(func) \
+	func(UBIFS, ubifs, 0) \
 	func(MMC, mmc, 0) \
 	func(USB, usb, 0) \
 	func(DHCP, dhcp, na)
diff --git a/include/configs/colibri_imx7_emmc.h b/include/configs/colibri_imx7_emmc.h
index 23d8eb94b1..bd437e543c 100644
--- a/include/configs/colibri_imx7_emmc.h
+++ b/include/configs/colibri_imx7_emmc.h
@@ -105,12 +105,8 @@
 	"load mmc 1:1 ${fdt_addr_r} ${soc}-colibri-emmc-${fdt_board}.dtb && " \
 	"run fdt_fixup && bootz ${kernel_addr_r} - ${fdt_addr_r}\0" \
 
-#ifdef CONFIG_TDX_EASY_INSTALLER
-#define CONFIG_BOOTCOMMAND "run distro_bootcmd"
-#else
-#define CONFIG_BOOTCOMMAND "run emmcboot; echo; echo emmcboot failed; " \
-	"setenv fdtfile ${soc}-colibri-emmc-${fdt_board}.dtb && run distro_bootcmd"
-#endif
+#define CONFIG_BOOTCOMMAND \
+	"setenv fdtfile ${soc}-colibri-emmc-${fdt_board}.dtb && run distro_bootcmd;"
 
 #define BOOTENV_RUN_NET_USB_START ""
 #define BOOT_TARGET_DEVICES(func) \
-- 
2.18.0

